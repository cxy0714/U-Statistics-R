% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ustat.R
\name{ustat}
\alias{ustat}
\title{Compute a Higher-Order U-Statistic via Python}
\usage{
ustat(
  tensors,
  expression,
  backend = c("torch", "numpy"),
  average = TRUE,
  dtype = NULL
)
}
\arguments{
\item{tensors}{A list of numeric vectors, matrices, or arrays representing
kernel evaluations. All tensors must have compatible dimensions.}

\item{expression}{Either a character string in Einstein notation or a list
of numeric vectors of length 1 or 2 describing index structure.}

\item{backend}{Character string specifying the computation backend:
\code{"torch"} (default) or \code{"numpy"}.}

\item{average}{Logical; if \code{TRUE} (default), return the averaged
U-statistic. Otherwise returns the raw sum.}

\item{dtype}{Optional character string specifying numeric precision for
tensors converted from R. Must be one of \code{"float32"} or
\code{"float64"}. If \code{NULL} (default), precision is chosen
automatically:
\itemize{
\item \code{float32} when using the Torch backend with CUDA available
\item \code{float64} otherwise
}}
}
\value{
A numeric scalar containing the computed U-statistic.
}
\description{
Computes a higher-order U-statistic from precomputed kernel tensors using
the Python package \code{u_stats}. This function serves as an R interface
and handles automatic data conversion via \pkg{reticulate}.
}
\details{
The U-statistic structure can be specified using either:
\itemize{
\item An Einstein summation string (e.g. \code{"ab,bc->"}), or
\item A nested list of index vectors (e.g. \code{list(c(1,2), c(2,3))})
}

This function requires a working Python environment with the
\code{u_stats} package installed. Use \code{setup_ustat()} to install
dependencies and \code{check_ustat_setup()} to verify configuration.

R numeric objects are converted to NumPy arrays using the selected
precision. If Python tensors (e.g., Torch tensors) are supplied directly,
they are passed through unchanged.
}
\examples{
\dontrun{
setup_ustat()

v1 <- runif(100)
H1 <- matrix(runif(100), 10, 10)
H2 <- matrix(runif(100), 10, 10)

ustat(list(H1, H2), "ab,bc->")
ustat(list(H1, H2), "ab,bc->", dtype = "float32")
ustat(list(H1, H2), "ab,bc->", dtype = NULL)  # auto precision
}
}
